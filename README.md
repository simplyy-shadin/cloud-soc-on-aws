# ðŸ§  Cloud-Based Security Operations Center (SOC) on AWS

![AWS](https://img.shields.io/badge/-AWS-orange?logo=amazon-aws&logoColor=white&style=for-the-badge)
![Wazuh](https://img.shields.io/badge/-Wazuh-blue?logo=wazuh&logoColor=white&style=for-the-badge)
![Suricata](https://img.shields.io/badge/-Suricata-red?logo=suricata&logoColor=white&style=for-the-badge)
![Elastic Stack](https://img.shields.io/badge/-Elastic_Stack-005571?logo=elastic&logoColor=white&style=for-the-badge)
![Shuffle SOAR](https://img.shields.io/badge/-Shuffle-green?logo=shuffle&logoColor=white&style=for-the-badge)
![Windows Server](https://img.shields.io/badge/-Windows_Server-0078D6?logo=windows&logoColor=white&style=for-the-badge)
![MIT License](https://img.shields.io/badge/-MIT-yellow?style=for-the-badge)


Ever wondered what it really takes to build a full-fledged **Security Operations Center (SOC)** â€” not just a theory lab, but a working environment that detects, analyzes, and responds to real threats?

That was exactly what I wanted to do. As a cybersecurity student, I wanted to go beyond "reading" about detection and response â€” I wanted to **see it happen**. So I took the challenge:

ðŸš€ **Build my own Cloud-based SOC on AWS from scratch.**

This post walks you through every phase of that journey â€” from architecture design to automation â€” showing how I turned a set of EC2 instances into a live, functional detection-and-response environment.

---

## ðŸ§© Table of Contents
* [ðŸ§  Why I Wanted to Build It](#-why-i-wanted-to-build-it)
* [â˜ï¸ Phase 1: Setting up the Cloud Infrastructure](#ï¸-phase-1-setting-up-the-cloud-infrastructure)
* [ðŸ” Phase 2: Integrating Detection Layers](#-phase-2-integrating-detection-layers)
* [âš™ï¸ Phase 3: Automating Incident Response](#ï¸-phase-3-automating-incident-response)
* [ðŸ¤– Phase 4: Adding SOAR Automation with Shuffle](#-phase-4-adding-soar-automation-with-shuffle)
* [ðŸªŸ Phase 5: Adding the Windows Detection Layer via ELK](#-phase-5-adding-the-windows-detection-layer-via-elk)
* [ðŸ§© Architecture Overview + Validation](#-architecture-overview--validation)
* [ðŸŽ¥ See it in Action](#-see-it-in-action)
* [ðŸ“š Lessons Learned](#-lessons-learned)
* [ðŸš€ Whatâ€™s Next](#-whats-next)
* [ðŸ’­ Final Thoughts](#-final-thoughts)
* [â­ Connect with me](#-connect-with-me)

---

## ðŸ§  Why I Wanted to Build It
Learning cybersecurity is one thing. But seeing how attacks are detected, correlated, and responded to in real time? Thatâ€™s a different level.

In a corporate SOC, multiple tools work together â€” EDR, IDS, SIEM, SOAR, WAF, and more. I wanted to simulate that in a way where I could:
* **Understand** how data flows between systems.
* **See** how alerts get triggered.
* And finally, **automate** what a real SOC analyst would do.

This was my playground to connect all the puzzle pieces.

---

## â˜ï¸ Phase 1: Setting up the Cloud Infrastructure
I started on **AWS** because it gave me flexibility, scalability, and easy networking between instances.

I deployed **five EC2 instances** using `t3.large` instance types, each serving a specific role in the SOC architecture:

| Instance          | Purpose                                                     |
| :---------------- | :---------------------------------------------------------- |
| `wazuh-manager`   | The brain â€” collects logs and runs detection rules.         |
| `wazuh-agent-1`   | A vulnerable host running DVWA for attack simulation.       |
| `suricata-ids`    | Network-level intrusion detection system.                   |
| `nginx-proxy`     | Reverse proxy + ModSecurity for web app protection.         |
| `windows-server`  | Windows environment integrated with Elastic Agent for endpoint visibility. |

Every instance had **Wazuh Agent** installed (except the manager), forwarding logs to the Wazuh Manager.

**Networking** was configured so I could simulate real attacks â€” SSH brute force, web exploits, SQLi â€” and trace them through my SOC pipeline.

---

## ðŸ” Phase 2: Integrating Detection Layers
A strong SOC depends on **visibility**. So I started layering detection from both **network** and **endpoint** perspectives.

### ðŸ§± Suricata IDS (Network Layer)
* Deployed on the `suricata-ids` instance.
* Operated in IDS mode to **monitor mirrored traffic**.
* Used custom rule sets for SSH brute force, port scans, and HTTP anomalies.
* Each alert generated by Suricata was forwarded to the **Wazuh Manager**, where it got enriched with host-level context.

This meant that when a network attack occurred, I could see **which host** was targeted and **what process** responded.

### ðŸ’¡ Wazuh (Host Layer + SIEM)
Wazuh was my **central SIEM and detection engine**.

I created custom rules â€” like triggering an alert when **five consecutive SSH login failures** occurred within a minute.

Wazuh also ingested logs from:
* Nginx (reverse proxy logs)
* ModSecurity (web attack events)
* Suricata (network alerts)
* System logs (`auth.log`, `syslog`, etc.)

This combination gave me **end-to-end visibility** across layers.

---

## âš™ï¸ Phase 3: Automating Incident Response
Detection is cool. But **response** is what separates a SOC from a log collector.

Hereâ€™s how I took automation to the next level:

### ðŸ§© Lambda + WAF + Security Groups
When a Wazuh alert detected a **brute-force attack**, it triggered an **AWS Lambda function** that:
* Extracted the attackerâ€™s IP.
* Blocked it automatically in both:
    * AWS **WAF**, and
    * AWS **Security Groups** (network-level firewall).
 
      **NOTE Lambda function:** The full Lambda implementation is available in the `lambda` branch â€” please check that branch for the complete code.


This made my SOC capable of **real-time mitigation** â€” the moment an attacker crossed the line, AWS itself shut them down.

---

## ðŸ¤– Phase 4: Adding SOAR Automation with Shuffle
To take it further, I integrated **Shuffle SOAR** â€” an open-source automation platform.

When Wazuh generated an alert:
1.  It was sent to a **Shuffle webhook**.
2.  Shuffle ran a playbook that:
    * Queried **VirusTotal** for IP reputation.
    * Classified the severity (e.g., â€œCriticalâ€ if VirusTotal showed multiple detections).
    * Sent an **email notification** to the SOC lead (me ðŸ˜Ž) with full details.

This became my first **end-to-end automated threat response loop** â€” detection â†’ enrichment â†’ notification â†’ action.

---

## ðŸªŸ Phase 5: Adding the Windows Detection Layer via ELK
To make the environment more realistic, I integrated a **Windows Server** into the SOC â€” not just as a log source, but as an intelligent detection node.

Hereâ€™s how it worked:
1.  The **Elastic Agent** on the Windows instance shipped event logs (like login attempts) to **Elastic Cloud**.
2.  Inside **Kibana**, I created **custom correlation rules** â€” for example:
    * â€œTrigger an alert if there are 5 consecutive SSH login failures within 1 minute.â€

When the rule fired, **Elasticsearch sent a webhook** directly to **Shuffle SOAR**.
Shuffle then:
* Performed a **VirusTotal check** on the source IP.
* Compiled the results into an **automated incident report**.
* Sent a detailed **email alert** to the SOC team lead with the attackerâ€™s IP reputation and event timeline.

This added an entire new dimension â€” now both **Linux and Windows** hosts were actively contributing to detection, correlation, and automated response.

It made my SOC feel closer to a **real-world, hybrid enterprise environment**.

## ðŸ§© Architecture Overview + Validation
Hereâ€™s a simplified flow of how everything connected:

```
+----------------+       +-------------------+       +-----------------+         +-----------------+        +-----------------+
|    Attacker    | ----> |   Nginx Proxy     | ----> |     DVWA        |  ---->  |   Suricata IDS  |        |  Windows Server |             
+----------------+       |  (ModSecurity)    |       | (Wazuh Agent)   |         +--------+--------+        | (Elastic Agent) |
                         +--------+----------+       +-------+---------+                  |                 +--------+--------+ 
                                  |                          |                            |                          |
                                  | (Mirrored Traffic)       | (Logs)                     | (Logs)                   | 
                                  |                          |                            |                          |
                                  |    +-------+---------+   |                            |                          |
                                  +->  |  Wazuh Manager  | <------------------------------+                          |
                                       +-------+---------+                                        (logs) +-----------+--------------+       
                                               |                                                   +---->|  Elastic Cloud / ELK     | 
                                               |                                                   |     | (Custom Detection Rules) |            
                                  +-------------------------+--------------------------------------+     +-----------+--------------+            
                                  |  (Alerts)               |  (Forward to SOAR)                                     |
                                  v                         v                                                        |
                          +-------+---------+       +-------+---------+             (custom rule triggered)          |
                          |   AWS Lambda    |       |   Shuffle SOAR  | <--------------------------------------------+
                          +-------+---------+       +-------+---------+
                                  |                          |
                                  | (Block IP via API)       | (VirusTotal Lookup,
                                  |                          |  Severity Check,
                                  |                          |  Email Notification)
                                  v                          v
                          +-------+---------+       +-----------------+
                          |  AWS WAF / SG   |       |     SOC Lead    |
                          |   (Block IP)    |       | (Email Alert)   |
                          +-----------------+       +-----------------+

          |
                                       

```



Once the architecture was complete, I validated the setup through **controlled attack simulations**:
* **Hydra** for SSH brute force and DVWA login.

Each attack was tracked end-to-end â€” Suricata detected it, Wazuh correlated it, and AWS Lambda auto-blocked the attackerâ€™s IP while Shuffle alerted me instantly.

Thatâ€™s when the SOC came alive â€” seeing alerts fire, automation kick in, and defences respond was like watching a digital battlefield unfold. âš”ï¸

---

## ðŸŽ¥ See it in Action
Watch the SOC project live in action on YouTube:

* **YouTube Video (Windows):** [https://youtu.be/7rIzMLEmPbA](https://youtu.be/7rIzMLEmPbA)
* **YouTube Video (Linux):** [https://youtu.be/_K8RWR_9hto](https://youtu.be/_K8RWR_9hto)

These videos demonstrate how traffic flows through the system, how alerts are generated, and how automated responses block attacks in real-time.

---

## ðŸ“š Lessons Learned
* **Correlation is king** â€” A single log is meaningless until you connect it with others.
* **Automation saves time** â€” SOAR platforms like Shuffle make response lightning-fast.
* **Visibility matters** â€” Suricata + Wazuh + Elastic is a powerful combo for full visibility.
* **Real attacks teach better than theory** â€” Simulating brute force, web attacks, and scans made me truly understand detection logic.

---

## ðŸš€ Whatâ€™s Next
This was just the beginning. My next steps are:
* Integrating **EDR (like CrowdStrike or Velociraptor)** for deeper endpoint visibility.
* Adding **Threat Intelligence feeds** into Wazuh correlation rules.
* Building **custom dashboards** in Kibana for attacker profiling.
* Reduce the amount of **False Positives** in the environment.

Ultimately, I want this to evolve into a **fully autonomous SOC lab** â€” one that detects, decides, and defends on its own.

---

## ðŸ’­ Final Thoughts
Building this SOC from scratch taught me more than months of theoretical learning ever could.

Itâ€™s not just about setting up tools â€” itâ€™s about **understanding how defenders think**, how data moves, and how automation can give you the upper hand in cybersecurity.

If youâ€™re a learner like me, donâ€™t wait for a â€œperfect lab setup.â€
* Start small.
* Break things.
* Connect systems.
* And most importantly, **learn from the alerts you trigger.**

Thatâ€™s how you turn from a studentâ€¦ into a real SOC analyst. ðŸ•µï¸â€â™‚ï¸

---

## â­ Connect with me
If you found this project inspiring, donâ€™t forget to star the repo!

Let's connect on ðŸ¤ [![LinkedIn](https://img.shields.io/badge/LinkedIn-Connect-blue?style=flat&logo=linkedin)](www.linkedin.com/in/shadin-k-v-cybersecurity)
Read this blog on âœï¸ [![Medium](https://img.shields.io/badge/Medium-Read-black?style=flat&logo=medium)](https://medium.com/@shdnkval/ï¸-building-my-own-cloud-soc-from-scratch-on-aws-786f3c5b61e4)

